\documentclass[a4paper,11pt]{article}
\usepackage[utf8]{inputenc}
\usepackage{amsmath}

%opening
\title{Variants on the Flight and Maintenance Planning problem}
\author{}

\setlength{\topmargin}{-2.1cm}
\setlength{\textwidth}{15.8cm}
\setlength{\textheight}{26.3cm}
\setlength{\oddsidemargin}{-0.1cm}
\setlength{\evensidemargin}{-0.1cm}

\def\II{{\mathcal{I}}}
\def\TT{{\mathcal{T}}}
\def\KK{{\mathcal{K}}}
\def\JJ{{\mathcal{J}}}

\usepackage{graphicx}
\usepackage{amssymb}
\usepackage{chngcntr}

\counterwithin*{equation}{section}
\counterwithin*{equation}{subsection}

\begin{document}

\maketitle

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Problem presentation}

    The problem consists in assigning military aircraft to a given set of missions while scheduling the maintenance operations over a time horizon.

    In order to generalize the formulation, from now on aircraft will be named "resources" and missions will be named "tasks". A series of $j \in \mathcal{J}$ tasks are planned along a horizon divided into $t \in \mathcal{T}$ periods. Since all tasks are already scheduled, we know time periods $T_j \subset \mathcal{T}$ in which they will be realized. Similarly, all the tasks to be realized in period $t$ are known and defined by set $J_t \subset \mathcal{J}$. Each task requires a certain number $r_{j}$ of resources $i \in \mathcal{I}$ which it employs for a time duration defined by $h_j$ in each period. Set $a_{j} \subset \mathcal{I}$ lists the resources that can be assigned to each task and set $O_i \subset \mathcal{J}$ consists of tasks for which resource $i$ can be used. The number of resources in use for each period $d_t$ is also known.

    Each resource can only be assigned to a single task in any given period. These resources suffer from wear and tear and require regular maintenance operations during their lifetime. The need for maintenance is calculated based on two indicators.

    The first one is called "remaining elapsed time" (or $ret_{it}$). It expresses the amount of time (measured in time periods) after which the resource cannot be used any more and has to undergo a maintenance operation. Its value is calculated for each resource $i$ and each time period $t$. In a similar way, "remaining usage time" (or $rut_{it}$) is used to measure the amount of time that the resource $i$ can be used before needing a maintenance operation at any given period $t$.

    Each maintenance operation has a fix duration of $M$ periods and cannot be interrupted: during this time the resource cannot be assigned to any task. After a maintenance operation, a resource restores its remaining elapsed time and remaining usage time to their maximum values $E$ and $H$ respectively.

    Some resources can be in maintenance at the beginning of the planning horizon, $n_t$ is used for the number of aircraft in such planned maintenance per period $t$ and defined only for the first $m-1$ time periods.

    Given that the creation of new tasks and the duration of maintenance are considered stochastic in real-life, one basic goal is to maximize the robustness of the planning by having the greatest amount of available resources at every period of the planning horizon. 

    Given the limited amount of maintenance capacity and its cost, another goal is to smooth as much as possible the number of resources under maintenance over the planning horizon.


\clearpage
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Crew scheduling variant}

    As presented in \cite{Brunner2013}. There, they prove the complexity by comparing the crew scheduling problem with the circulant problem. Below I do the same with our problem.

    \subsection{Hypothesis}

    \begin{itemize}
     \item fixed maintenance duration.
     \item fixed duration between maintenances.
     \item homogeneous fleet.
     \item objective: minimize the number of aircraft.
    \end{itemize}

    \subsection{Reductions}

    \begin{itemize}
        \item The missions consume 0 hours of aircraft.
        \item The minimum time between maintenances is equal to the maximum.
        \item All missions can use any aircraft.
    \end{itemize}

    \subsection{Limitations}

    \begin{itemize}
        \item There is not starting period.
    \end{itemize}

    \subsection{Notations}

    \textbf{Sets}

    \begin{tabular}{ll}
    $t \in \mathcal{T} = [\![1, m]\!]$ & Planning horizon periods. \\
    $i \in \mathcal{P} = [\![1, n]\!]$ & Working pattern.\\
    \end{tabular}

    \vskip 0.3cm

    \subsection{Parameters}

    \begin{tabular}{ll}
        $D^{off}$ & Number of consecutive non-working days. \\
        $D^{on}$ & Number of consecutive working days. \\
        $\mathcal{A}_{it}$ & Pattern $i$ covers period $t$ (circulant matrix built from $D_{on}$ and $D_{off}$).\\
        $b_{t}$ & Need of resources at period $t$. \\
    \end{tabular}

    \vskip 0.3cm

    Example of A for $D_{on}=4$ and $D_{off}=2$

    $$
    \begin{bmatrix}
        1 & 0 & 0 & \dots  & A_{i1} \\
        1 & 1 & 0 & \dots  & A_{i2} \\
        1 & 1 & 1 & \dots  & A_{i3} \\
        1 & 1 & 1 & \dots  & A_{i4} \\
        0 & 1 & 1 & \dots  & A_{i5} \\
        0 & 0 & 1 & \dots  & A_{i6} \\
        1 & 0 & 0 & \dots  & A_{i6} \\
        \vdots & \vdots & \vdots & \ddots & \vdots \\
        A_{1t} & A_{2t} & A_{3t} & \dots  & A_{nm}
    \end{bmatrix}
    $$

    \subsection{Variables}

    \begin{itemize}
     \item $x_i$: number of patterns of type $i$ to be included in the solution.
    \end{itemize}

    \subsection{Model}

    \begin{align}
        & \text{Min}\; \sum_{i \in \mathcal{P}} x_i \label{numPatterns}
    \end{align}

    \begin{align}
        & \sum_{i \in \mathcal{P}} A_{it}x_{i} \geq d_j & t \in \mathcal{T} \label{demand} \\
        & x_{i} \geq 0,\, x_{i} \in \mathbb{Z} \\
    \end{align}

    (\ref{numPatterns}) minimizes the number of workers. (\ref{demand}) defines the need to have at least a given number of workers at any given time.  

\clearpage
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Set covering variant}

    \subsection{Hypothesis}

    \begin{itemize}
     \item only 1 aircraft needed per month.
     \item objective: minimize the number of aircraft.
    \end{itemize}

    \subsection{Notations}

    \textbf{Sets}

    \begin{tabular}{ll}
    $t\in \mathcal{T} = [\![1, m]\!]$ & Planning horizon periods. \\
    $i \in \mathcal{P} = [\![1, n]\!]$ & Working pattern.\\
    \end{tabular}

    \vskip 0.3cm

    \subsection{Parameters}

    \begin{tabular}{ll}
        $\mathcal{A}_{it}$ & Pattern $i$ covers period $t$.\\
    \end{tabular}

    \vskip 0.3cm

    \subsection{Variables}

    \begin{itemize}
     \item $x_i$: is pattern $i$ in the solution or not.
    \end{itemize}

    \subsection{Model}

    \begin{align}
        & \text{Min}\; \sum_{i \in \mathcal{P}} x_i \label{numPatterns2}
    \end{align}

    \begin{align}
        & \sum_{i \in \mathcal{P}} A_{it}x_{i} \geq 1 & t \in \mathcal{T} \label{demand2} \\
        & x_{i} \in \{0, 1\} \\
    \end{align}

    (\ref{numPatterns2}) minimizes the number of workers. (\ref{demand2}) defines the need to have at least one worker working at any given time.  

\clearpage
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Scheduling variant}

    \subsection{Hypothesis}

    \begin{itemize}
     \item durée de maintenance définie
     \item fenêtres de temps pour commencer les maintenances
     \item objectif: lisser les maintenances dans les fenêtres de temps prédéfinies
    \end{itemize}


    \subsection{Notations}

    \noindent{
    \begin{tabular}{ll}
        $t\in \TT = [\![1, T]\!]$ & Discrétisation temporelle de l'horizon de planigfication. \\
        $i \in \II = [\![1, I]\!]$ & Ensemble des avions.\\
        $k \in \KK_i = [\![1, K_i]\!]$ & Ensemble des maintenances à planifier successivement.\\ 
    \end{tabular}
    }

    \vskip 0.3cm

    \textbf{Paramètres}


    \begin{tabular}{ll}
        $\mathbf{Da}_{i,k}$ & Durée nominale de la maintenance $k$ de l'avion $i$.\\
        $\mathbf{l}_{i}$ & Durée mininale du cycle de vol de l'avion $i$.\\
        $\mathbf{{To}}_{i,k}$ & Pas de temps le plus tôt pour commencer la maintenance $k$ de l'avion $i$.\\
        $\mathbf{{Ta}}_{i,k}$ & Pas de temps le plus tard pour terminer la maintenance $k$ de l'avion $i$.\\
    \end{tabular}

    % \caption{Definition and notations the challenge ROADEF}\label{contraintesROADEF}
    % \end{table}

    \subsection{Définition des variables}

    \begin{itemize}
     \item $d_{i,k,t}\in \{0,1\}$; variables binaires pour indiquer les dates d'arrêts, "step varaibles" 
    $d_{i,k,t}=1$ si l'arrêt du cycle $k$ du réacteur nucléaire $i$ a été commencé avant la semaine $t$.
    $d_{i,k,t}-d_{i,k,t- {\mathbf{Da}_{i,k}}} \in \{0,1\}$ vaut $1$ uniquement pendant a maintenance $(i,k)$.


     \item $m,M\geqslant 0$: variables continues pour linéariser la fonction objectif
    \end{itemize}


    \subsection{Formulation PLNE}


    \begin{eqnarray}
    \displaystyle \min_{d,m,M} & M-m
     & \\
    \forall i , k, t, & d_{i,k,t-1}\leqslant d_{i,k,t} & \label{PANprecedence}\\
    \forall i , k, & d_{i,k,\mathbf{To}_{i,k}-1}\leqslant 0 & \label{PANtw0} \\
    \forall i , k, & d_{i,k,\mathbf{Ta}_{i,k}}\geqslant 1 & \label{PANtw1}\\
    \forall i , k, t, & d_{i,k,t}\leqslant d_{i,k-1,t-l_i-\mathbf{Da}_{i,k}} & \label{PANprecedence2}\\
    \forall t, & \displaystyle \sum_{i,k} d_{i,k,t}-d_{i,k,t- {\mathbf{Da}_{i,k}}} \leqslant M & \label{maxMaint}\\
    \forall t, & \displaystyle \sum_{i,k} d_{i,k,t}-d_{i,k,t- {\mathbf{Da}_{i,k}}} \geqslant m & \label{minMaint}\\
    & d \in \{0,1\}^N, m,M \geqslant 0
    \end{eqnarray}

    (\ref{PANprecedence}): contrainte induite par la définition ``step variables".

    (\ref{PANtw0}), (\ref{PANtw1}): contraintes de fenêtres de temps (écrit explicitement, ou sinon définir uniquement les variables $d_{i,k,t}$
    dans les fenêtres de temps)

    (\ref{PANprecedence2}): durée minimale d'un cycle de vol $l\geqslant 0$, contrainte de succession des cycles.

    (\ref{maxMaint}), (\ref{minMaint}): contraites pour linéariser les $\min$ et $\max$ de la focntion objectif de lissage

    \subsection{Questions ouvertes}

    \begin{itemize}
    %\item Avec $l=0$ , y a t'il un problème de référence proche ? Ordonnancement, lissage de charge ?
    \item Avec $l=0$ , y a t'il un problème de référence proche ? Ordonnancement, lissage de charge ?
    \item Est-ce un problème NP-complet? Peut on le prouver ?
     \item Cas particulier $\mathbf{Ta}_{i,k}-\mathbf{To}_{i,k}=1$? (pour lissage local)
     \item Autres fonctions objectifs?
     \item version robuste avec aléas de prolongation de durée de maintenance?
    \end{itemize}

\clearpage
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Crew scheduling: smooth maintenances}

    \subsection{Hypothesis}

    \begin{itemize}
     \item fixed maintenance duration.
     \item range to start each maintenance.
     \item min distance between maintenances.
     \item objective: minimize the max number of maintenances.
    \end{itemize}

    \subsection{Notations}

    \textbf{Sets}

    \begin{tabular}{ll}
    $t\in \mathcal{T} = [\![1, m]\!]$ & Planning horizon periods. \\
    $i \in \mathcal{P} = [\![1, n]\!]$ & Working pattern.\\
    \end{tabular}

    \vskip 0.3cm

    \subsection{Parameters}

    \begin{tabular}{ll}
        $\mathcal{A}_{it}$ & Pattern $i$ has a maintenance in $t$.\\
    \end{tabular}

    \vskip 0.3cm

    Here, A needs to be created taking into account:

    \begin{enumerate}
        \item The range of start of maintenances.
        \item The fixed duration of maintenances.
        \item The minimal distance between maintenances.
    \end{enumerate}

    \subsection{Variables}

    \begin{itemize}
        \item $x_i$: number of patterns of type $i$ to be included in the solution.
        \item $M$: maximum number of maintenance among all periods.
    \end{itemize}

    \subsection{Model}

    \begin{align}
        & \text{Min}\; M
    \end{align}

    \begin{align}
        & \sum_{i \in \mathcal{P}} A_{it}x_{i} \leq M & t \in \mathcal{T} \label{numMaint} \\
        & x_{i} \geq 0,\; integer \\
    \end{align}

        (\ref{numMaint}) defines the $M$ variable as the maximum number of maintenances at any period of time.


\clearpage
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Scheduling variant 2}

    As modelled in \cite{Rieck2012} and \cite{Neumann2000}.

    \subsection{Hypothesis}

    \begin{itemize}
     \item fixed maintenance duration.
     \item min and max durations between maintenances that belong to the same aircraft.
     \item each maintenance uses an amount of resource. In this case 1.
     \item there is a maintenance capacity to respect at every period.
     \item objective: minimize the max number of maintenances.
     \item There are two artificial activities representing the start and end of the horizon.
     \item maintenance operations consume also resources of the missions.
    \end{itemize}

    \subsection{Reductions}

    \begin{itemize}
        \item The missions consume 0 hours of aircraft.
        %\item The missions require 0 aircraft at each period.
        \item Each aircraft can only be used for one mission.
    \end{itemize}

    \subsection{Limitations}

    \begin{itemize}
        \item Resource usage is always 1.
        %\item There is only one type of resource.
        \item All durations are the same.
    \end{itemize}

    \subsection{Notations}

    \textbf{Sets}

    \noindent{
    \begin{tabular}{ll}
        $i \in \mathcal{V} = [\![1, n]\!]$ & Set of maintenance operations.\\
        $(i, j) \in \mathcal{E} = [\![1, v]\!]$ & Set of consecutive (i, j) maintenance operations, i.e. consecutive maintenances belonging to the same aircraft.\\
        $k \in \mathcal{R}$ & Types of resources that maintenance can take. We only have one type.\\
        $i = 0$ & Artificial starting node.\\
        $i = n+1$ & Artificial ending node.\\
    \end{tabular}
    }

    \vskip 0.3cm

    The set $\mathcal{A}$ we will construct it by deciding in advance the maintenances $i$ that share the same aircraft.

    \subsection{Parameters}

    \begin{tabular}{ll}
        $p_i$ & Duration of maintenance $i$. In this case it's always p=6.\\
        $\mathbf{d}$ & Last period on the horizon.\\
        $r_{ik}$ & Resources of type $k$ taken by maintenance $i$. In this case it's always 1.\\
        $d^{max}_{ij}$ & Maximum duration between two maintenances $i$ and $j$.\\
        $d^{min}_{ij}$ & Minimum duration between two maintenances $i$ and $j$.\\
        ${\delta}_{ij}$ & Precedence duration arcs between two maintenances $i$ and $j$ based on $d^{max}$ and $d^{min}$.\\
        $R_k$ & total maintenance capacity at each period for resource $k$.\\
        $c_k$ & cost per unit of investment on resource $k$.
        % $\mathbf{{To}}_{i,k}$ & Minimum starting period for maintenance $k$ of resource $i$.\\
        % $\mathbf{{Ta}}_{i,k}$ & Maximum starting period for maintenance $k$ of resource $i$.\\
    \end{tabular}

    \subsection{Variables}

    \begin{tabular}{ll}
        $S_i$ & the start of maintenance operation $i$.\\
        $\mathcal{A}(S^{\mathcal{C}}, t)$ & set of maintenance operations active at moment $t$.\\
    \end{tabular}

    \subsection{Model}

    The following formulation is taken from \cite{Neumann2000}.

    \begin{align}
        \min f(\mathbf{R}(S)) = \sum_{k \in \mathcal{R}} c_k \max_{t \in \mathcal{T}} r_k(S^{\mathcal{C}}, t)
    \end{align}

    \begin{align}
        & S_j - S_i \geq \delta_{ij} & (i, j) \in \mathcal{E}  \label{precedence}\\
        & S_0 = 0 &  \label{firstjob}\\
        & S_{n+1} \leq \mathbf{d}   \label{lastjob}\\
        & S_{i} \in \mathbb{Z}_{\geq 0} & i \in \mathcal{V}  \label{integervars}\\
        & r_k(S^{\mathcal{C}}, t) = \sum_{i \in \mathcal{A}(S^{\mathcal{C}}, t)} r_{ik}  \label{consumptiondef}\\
        & r_k(S^{\mathcal{C}}, t) \leq R_k \label{consumptionmax}\\
    \end{align}

    (\ref{precedence}) constraints define the relative minimum and maximum starting times of tasks.
    (\ref{firstjob}) and (\ref{lastjob}) constraints define the fictitious start and end jobs.
    (\ref{integervars}) define the range for the starting time variables: integer positive.
    (\ref{consumptiondef}) defines the used quantity for each type of resource depending on the starting times and durations and (\ref{consumptionmax}) defines the maximum amount of resources of each type that can be used at any given time.

    \subsection{Possible proof}

    \cite{Blazewicz1983} proved that the following problem is NP-Hard:

    $$P2 | res111, chain, p_j = 1 / C_{max}$$ is NP-hard via the 3 partition problem.

    This problem is, from what I understand, the following:

    \begin{itemize}
        \item The number of machines is 2.
        \item There is only one type of resource.
        \item The resource size is 1.
        \item The consumption of the resource by each job is upper bounded by 1.
        \item The duration of each job is 1.
        \item There is a chain precedence between jobs: a job can have at most one predecessor and one successor.
    \end{itemize}

    Here they use the machine and resource concept. This could be understood as there being TWO resource types. Not sure how to really come around this. Is the same, for example, as doing the following:

    $$P| res1R1, chain, p_j = 1 / C_{max}$$ Where I have an unlimited number of machines and a quantity R of available resource?

    Although they minimize the maximum completion time, the decision problem 'is there a planning that uses X number of resources and finishes before period Y' is the same as ours. When we pass to the optimization problem we just choose the number of resources instead of the time.


\clearpage
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Three partition problem}


    \subsection{Hypothesis}

    \begin{itemize}
     \item assigned maintenances at regular intervals of M.
     \item We need to assign tasks in between maintenances.
     \item Each task assignment needs M/3 consecutif periods.
     \item Each task assignment has a flight hours consumption.
    \end{itemize}

    \subsection{Reductions}

    \begin{itemize}
        \item Missions have a fixed duration.
        \item Maintenances are evenly spaced.
        \item All maintenances start at the same time. Maybe only one maintenance per Aircraft.
        % \item The missions require 0 aircraft at each period.
        % \item Each aircraft can only be used for one mission.
    \end{itemize}

    \subsection{Limitations}

    \begin{itemize}
        \item The time at which each task is done matters.
        %\item There is only one type of resource.
        % \item All durations are the same.
    \end{itemize}

    \subsection{Notations}

    \textbf{Sets}

    \noindent{
    \begin{tabular}{ll}
        $i \in \II = [\![1, I]\!]$ & Set of aircraft.\\
        % $k \in \KK_i = [\![1, K_i]\!]$ & Set of maintenances for aircraft $i$.\\ 
        $j \in J$ & Set of missions.\\ 
        % $i \in \mathcal{V} = [\![1, n]\!]$ & Set of maintenance operations.\\
        % $k \in \mathcal{R}$ & Types of resources that maintenance can take. We only have one type.\\
        % $i = 0$ & Artificial starting node.\\
        % $i = n+1$ & Artificial ending node.\\
    \end{tabular}
    }

    \subsection{Parameters}

    \begin{tabular}{ll}
    	$h_j$ & Flight hour consumption for each mission.\\
    	$M$ & Duration of maintenances.\\
    	$H$ & Flight hours given by maintenance.\\
        % $p_i$ & Duration of maintenance $i$. In this case it's always p=6.\\
        % $\mathbf{d}$ & Last period on the horizon.\\
        % $r_{ik}$ & Resources of type $k$ taken by maintenance $i$. In this case it's always 1.\\
        % $d^{max}_{ij}$ & Maximum duration between two maintenances $i$ and $j$.\\
        % $d^{min}_{ij}$ & Minimum duration between two maintenances $i$ and $j$.\\
        % ${\delta}_{ij}$ & Precedence duration arcs between two maintenances $i$ and $j$ based on $d^{max}$ and $d^{min}$.\\
        % $R_k$ & total maintenance capacity at each period for resource $k$.\\
        % $c_k$ & cost per unit of investment on resource $k$.
        % $\mathbf{{To}}_{i,k}$ & Minimum starting period for maintenance $k$ of resource $i$.\\
        % $\mathbf{{Ta}}_{i,k}$ & Maximum starting period for maintenance $k$ of resource $i$.\\
    \end{tabular}

    In theory, with this configuration we have a Three Partition problem. The problem lies that each task has a fixed time. They're not tasks, they're demand. 		

    % This doesn't make sense because the tasks are already defined. We cannot chose when it executes.

    % I'll continue with the idea nonetheless.
    % Imagine we preassign the aircraft a group of tasks. We need to decide at which moment we want to assign the tasks in the predefined maintenances.
    % In this way, we need to come up with an assignment of tasks for each cycle that has a total of 1000 flight hours.


\clearpage
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Three partition problem v2}

    Inspired by \cite{Caprara2003}.

    \subsection{Hypothesis}

    \begin{itemize}
     \item all maintenances are already decided for all aircraft and they will happen in month 4.
     \item all aircraft come from receiving a maintenance so are full in availability and flight hours.
     \item each maintenance gives C flight hours.
     \item objective: comply with all the missions in time and arrive with 0 flight hours to the maintenance.
     \item each mission lasts for 3 months, needs 1 aircraft each month.
     \item There is no minimal assignment duration for missions.
    \end{itemize}

    % \subsection{Reductions}

    % \begin{itemize}
    %     \item The missions consume 0 hours of aircraft.
    %     %\item The missions require 0 aircraft at each period.
    %     \item Each aircraft can only be used for one mission.
    % \end{itemize}

    % \subsection{Limitations}

    % \begin{itemize}
    %     \item Resource usage is always 1.
    %     %\item There is only one type of resource.
    %     \item All durations are the same.
    % \end{itemize}

    \subsection{Notations}

    \textbf{Sets}

    \noindent{
    \begin{tabular}{ll}
        $i \in \II = [\![1, M]\!]$ & Set of aircraft fleets. Each fleet has 3 aircraft.\\
        $j \in \mathcal{J} = [\![1, 3M]\!]$ & Set of missions.\\
        $t \in \TT = [\![1, 3]\!]$ & Set of periods.\\
        $p \in \mathcal{P} = [\![1, 3]\!]$ & Set of aircraft per fleet.\\
        $A_{ip}$ & Aircraft number $p$ of fleet $i$. \\
    \end{tabular}
    }

    \vskip 0.3cm

    \subsection{Parameters}

    \begin{tabular}{ll}
        $M$ & Number of fleets.\\
        $3M$ & Number of aircraft and missions.\\
        $D$ & Months between maintenances. Fixed to three.\\
        $h_j$ & Flight hour consumption for each mission.\\
        $C$ & Flight hours given by maintenance.\\
    \end{tabular}

    \subsection{Variables}

    \begin{tabular}{ll}
        $F_{ij}$ & Mission $j$ is done by fleet $i$. Binary. \\
        $a_{ipjt}$ & Mission $j$ is done by aircraft number $p$ from fleet $i$ in period $t$ (auxiliary). Binary. \\
    \end{tabular}

    \subsection{Model}

    It's a satisfaction problem where we want to use exactly all the available hours to do missions. We could also calculate the "waste hours just before the maintenance" and then it could be a minimisation problem.

    \begin{align}
        & \sum_{t \in \mathcal{T}, j \in \mathcal{J}} a_{ipjt} \times h_j = C & (i \in \mathcal{I}, p \in \mathcal{P}) \label{hours}\\
        & \sum_{i \in \mathcal{I}, p \in \mathcal{P}} a_{ipjt} = 1 & (j \in \mathcal{J}, t \in \mathcal{T}) \label{demand-TPP}\\
        & F_{ij} \leq \sum_{p \in \mathcal{P}, t \in \mathcal{T}} a_{ipjt} & (i \in \mathcal{I}, j \in \mathcal{J}) \label{auxiliary1}\\
        & F_{ij} \geq a_{ipjt} & (i \in \mathcal{I}, p \in \mathcal{P}, t \in \mathcal{T}, j \in \mathcal{J}) \label{auxiliary2}\\
        & \sum_{i \in \mathcal{I}} F_{ij} = 1 &  (j \in \mathcal{J}) \label{auxiliary3}\\
        & F_ij, a_{ipjt} \geq 0,\, F_{ij}, a_{ipjt} \in \mathbb{B}
    \end{align}

    (\ref{hours}) constraints force the number of hours each aircraft uses to be exactly the number of available hours.
    (\ref{demand-TPP}) constraints force the solution to have exactly 1 aircraft assigned to each mission at each period.
    (\ref{auxiliary1}) and (\ref{auxiliary2}) constraints tie the fleet assignment with the single aircraft assignment.
    (\ref{auxiliary3}) controls that each mission is only assigned to one fleet.

    \subsection{Possible proof}

    Each fleet is assigned three missions. These missions need to sum the available amount of flight hours (C).
    Because we need to satisfy the assignment of aircraft each month, each aircraft belonging to the fleet will have a different combination of the three missions (three permutations in a cycle: ABC, CBA, BCA).

    For example if the missions with flight hours (60, 30, 10) are assigned to fleet 1 and the missions with flight hours (50, 40, 10) are assigned to fleet "3M". In this case C=100. One could have the following solution:

    $$
    \begin{bmatrix}
        A_{11} & 60 & 30 & 10 \\
        A_{12} & 10 & 60 & 30 \\
        A_{13} & 30 & 10 & 60 \\\hline
        \vdots & \vdots & \vdots & \vdots \\\hline
        A_{n1} & H_i & H_j & H_k \\
        A_{n2} & H_k & H_i & H_j \\
        A_{n3} & H_j & H_k & H_i \\\hline
        \vdots & \vdots & \vdots & \vdots \\\hline
        A_{3M1} & 50 & 40 & 10  \\
        A_{3M2} & 10 & 50 & 40  \\
        A_{3M3} & 40 & 10 & 50  \\\hline
    \end{bmatrix}
    $$

    We need to comply with having at least one aircraft assigned to each mission per month. Since we have 3M aircraft, we can do this exactly by assigning all slots.

    The solution to this problem should give a solution to the Three Partition Problem. It would just suffice to take the three missions assigned to each fleet (the order is irrelevant) and use this as a solution of M groups (corresponding to M fleets). In other words, the contents of the variable $F_{ij}$.

    It's true that in the original problem we do not have the concept of fleet... but maybe we can reformulate the definitions to make it even easier.

    I think we could get the fleet part out if we would guarantee that each aircraft has an "alldifferent" assignment of three missions. This would guarantee that the solution of the problem would still be equivalent to the fleet one.

\clearpage
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{3 Dimensional matching}

Here I want to prove that... I need three dimensions. Resource-months, Mission-months and cycles.

I want to decide if a task-month is assigned to a resource-month inside the cycle.

Possibilities are constrained by saying.
Every misision-month needs to be covered.
Every resource-month needs to be covered.

\clearpage

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{other notes}

If I take the shifts models that were polynomial... given that they become hard when adding limits on the number of shifts per planning horizon and if I have flight hours that vary between "shifts"; this means that I can traduce the flight hours in this... maybe? see: 2.4.3 from \cite{Smet2015}.


\clearpage

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Crew scheduling variant 2}

    Based on an existing problem formulated in \cite{Smet2015} and proved in \cite{Brunner2013}.

    The objective of the problem discussed by \cite{Brunner2013} is to minimise the size of the workforce. Apart from coverage requirements, expressed as a minimum ($b_{t}$), there are three other constraints. The first constraint limits the number of days worked to a maximum value ($\overline{D}^{work}$). The second and third constraints define a range on the number of consecutive days worked ($\underline{D}^{on} - \overline{D}^{on}$) and days-off ($\underline{D}^{off} - \overline{D}^{off}$), respectively.

    All missions can use any aircraft (homogeneous fleet). 
    Even if we have a fixed (not a range) number of consecutive non-working days, the original proof was made with both ranges being fixed.

    Now, a simplified description of the original problem is done that matches this problem:

    For each period $t$ with demand $b_{t}$, we create a task $j$ with $T_j = \{t\}$ that requires $r_{j}$ resources.
    For each worker $i$ we have a corresponding resource $i$.
    Since the workforce has the same skills, we assume $O_i = \{j \in \mathca{J}\}$.


    A series of $j \in \mathcal{J}$ tasks are planned along a horizon divided into $t \in \mathcal{T}$ periods. Since all tasks are already scheduled, we know time periods $T_j \subset \mathcal{T}$ in which they will be realized. Similarly, all the tasks to be realized in period $t$ are known and defined by set $J_t \subset \mathcal{J}$. Each task requires a certain number $r_{j}$ of resources $i \in \mathcal{I}$ which it employs for a time duration defined by $h_j$ in each period. Set $a_{j} \subset \mathcal{I}$ lists the resources that can be assigned to each task and set $O_i \subset \mathcal{J}$ consists of tasks for which resource $i$ can be used. The number of resources in use for each period $d_t$ is also known.

    Each resource can only be assigned to a single task in any given period. These resources suffer from wear and tear and require regular maintenance operations during their lifetime. The need for maintenance is calculated based on two indicators.

    The first one is called "remaining elapsed time" (or $ret_{it}$). It expresses the amount of time (measured in time periods) after which the resource cannot be used any more and has to undergo a maintenance operation. Its value is calculated for each resource $i$ and each time period $t$. In a similar way, "remaining usage time" (or $rut_{it}$) is used to measure the amount of time that the resource $i$ can be used before needing a maintenance operation at any given period $t$.

    Each maintenance operation has a fix duration of $M$ periods and cannot be interrupted: during this time the resource cannot be assigned to any task. After a maintenance operation, a resource restores its remaining elapsed time and remaining usage time to their maximum values $E$ and $H$ respectively.

    Some resources can be in maintenance at the beginning of the planning horizon, $n_t$ is used for the number of aircraft in such planned maintenance per period $t$ and defined only for the first $m-1$ time periods.

    Given that the creation of new tasks and the duration of maintenance are considered stochastic in real-life, one basic goal is to maximize the robustness of the planning by having the greatest amount of available resources at every period of the planning horizon. 

    Given the limited amount of maintenance capacity and its cost, another goal is to smooth as much as possible the number of resources under maintenance over the planning horizon.


    The notation follows closely the \cite{Smet2015} 2.6.1 example.

    \subsection{Hypothesis}

    \begin{itemize}
         \item objective: minimize the number of aircraft to maximize availability.
    \end{itemize}

    \subsection{Reductions}

    \begin{itemize}
        \item The missions consume 0 hours of aircraft.
        \item The set of $j \in \mathcal{J}$ tasks
        \item No minimum duration for mission assignments.
    \end{itemize}

    \subsection{Notations}

    \textbf{Sets}

    \begin{tabular}{ll}
        $t \in \mathcal{T}$ & Planning horizon periods. \\
        $i \in \mathcal{I}$ & Resources. \\
    \end{tabular}

    \vskip 0.3cm

    \subsection{Parameters}

    \begin{tabular}{ll}
        $\overline{D}^{work}$ & Maximum number of total working days in period. \\
        $D^{off}$ & Number of consecutive non-working days. \\
        $\overline{D}^{on}$ & Maximum number of consecutive working days. \\
        $\underline{D}^{on}$ & Minimum number of consecutive working days. \\
        $b_{t}$ & Need of resources at period $t$. \\
    \end{tabular}

    \vskip 0.3cm

    \subsection{Variables}

    \begin{itemize}
        \item $x_{it}$: resource $i$ is working on period $t$.
        \item $y_{i}$: resource $i$ is working on at least one period.
    \end{itemize}

    \subsection{Model}

    \begin{align}
        & \text{Min}\; \sum_{i \in \mathcal{I}} y_{i} \label{min_num_resources}
    \end{align}

    \begin{align}
        & \sum_{i \in \mathcal{I}} x_{it} \geq b_t & t \in \mathcal{T} \label{demand3} \\
        & \sum_{t \in \mathcal{T}} x_{it} \leq \overline{D}^{work} & i \in \mathcal{I} \label{max_work} \\
        & \sum_{t' = t}^{\overline{D}^{on}+t-1} x_{it'} \leq \overline{D}^{on} & i \in \mathcal{I}, t \in \mathcal{T} \label{max_work_days} \\
        & \sum_{t' = t}^{\underline{D}^{on}+t-1} x_{it'} \geq \underline{D}^{on} (x_{it} - x_{it-1}) & i \in \mathcal{I}, t \in \mathcal{T} \label{min_work_days} \\
        & \sum_{t' = t}^{D^{off}+t-1} (1 - x_{it'}) \leq D^{off} & i \in \mathcal{I}, t \in \mathcal{T} \label{max_no_work_days} \\
        & \sum_{t' = t}^{D^{off}+t-1} (1 - x_{it'}) \geq D^{off} (- x_{it} + x_{it-1}) & i \in \mathcal{I}, t \in \mathcal{T} \label{min_no_work_days} \\
        & y_{i} \geq x_{it} & i \in \mathcal{I}, t \in \mathcal{T} \label{num_resources} \\
        & x_{it}, y_{i} \in \{0, 1\} & i \in \mathcal{I}, t \in \mathcal{T} \label{binary}
    \end{align}

    Constraints (\ref{demand3}) guarantee the necessary number of workers is available to work. 
    Constraints ((\ref{max_work}) checks that the total number of working days for each worker is less than the upper limit.
    Constraints (\ref{max_work_days} - \ref{min_work_days}) control the resources meet the range of working days. Constraints (\ref{max_no_work_days} - \ref{min_no_work_days}) control the resources meet the fixed number of non-working days.
    Finally constraints (\ref{num_resources}) quantify the number of necessary workers in the planning to be minimized in (\ref{min_num_resources}).

\clearpage
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%



% \bibliographystyle{dcu}
\bibliographystyle{alpha}
\bibliography{./../../biblio/Scheduling,./../../biblio/NRP}

\end{document}




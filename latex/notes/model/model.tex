\documentclass[a4paper,onecolumn,fleqn]{article}
\textwidth 17cm \textheight 247mm
\topmargin -4mm
\hoffset -9mm \voffset -14mm
%\setlength{\topmargin}{-0.8truecm}
\setlength{\oddsidemargin}{0.3cm}
\setlength{\evensidemargin}{0.3cm}
\setlength{\columnsep}{8mm}
\setlength{\parindent}{0mm}
\setlength{\parskip}{-2.0ex}
\setlength{\mathindent}{0mm}
\flushbottom


\usepackage{epsfig}
%\usepackage{timesnew}
% \usepackage{harvard}
% \usepackage[]{natbib}
\usepackage{amsmath}
\usepackage{booktabs}

\usepackage[latin1]{inputenc}
% \usepackage{aeguill}
\usepackage[english]{babel}
\usepackage{caption}


\setlength{\parskip}{2ex} \pagestyle{myheadings}
% \markright{\hspace*{3.8cm} \textit{MOSIM18 - June 27-29, 2018 - Toulouse - France}}

\renewcommand{\thepage}{}
\renewcommand{\refname}{REFERENCES}



\makeatletter
\renewcommand\section{\@startsection{section}{1}{\z@}%
                       {-6\p@ \@plus -0\p@ \@minus -0\p@}%
                       {2\p@ \@plus 0\p@ \@minus 0\p@}%
                       {\normalsize\textbf}}

\renewcommand\subsection{\@startsection{subsection}{2}{\z@}%
                       {-6\p@ \@plus -0\p@ \@minus -0\p@}%
                       {2\p@ \@plus 0\p@ \@minus 0\p@}%
                       {\normalsize\textbf}}

\renewcommand\subsubsection{\@startsection{subsubsection}{3}{\z@}%
                       {-6\p@ \@plus -0\p@ \@minus -0\p@}%
                       {1\p@ \@plus 0\p@ \@minus 0\p@}%
                       {\normalsize\itshape\bfseries}}
\makeatother


\begin{document}

\section{Optimization model}
  \label{sec:model}

  \subsection{Basic sets}

    \begin{tabular}{p{5mm}p{170mm}}
        $\mathcal{I}$     &  resources. \\
        $\mathcal{T}$     &  time periods inside planning horizon. \\
        $\mathcal{J}$     &  tasks. \\
        $\mathcal{K}$     &  cluster of resources that share the same capacities to do tasks. \\
    \end{tabular}

  \subsection{Parameters}

    \begin{tabular}{p{8mm}p{167mm}}
        $H_j$             & amount of resource time required by task $j$. \\
        $R_j$             & number of resources required by task $j$. \\
        $MT_j$            & minimum number of consecutive periods a resource can be assigned to task $j$. \\
        % $aut_i$           & maximal absolute usage time for resource $i$. \\
        % $aet_i$           & maximal absolute elapsed time for resource $i$. \\
        $M$               & maintenance duration in number of periods. \\
        $M^{max}$         & maximum number of simultaneous maintenance operations. \\
        % $E$               & remaining elapsed time after a maintenance. \\
        $E^{M}$         & maximum number of periods between two consecutive maintenances. \\
        $E^{m}$         & minimum number of periods between two consecutive maintenances. \\
        $H$               & remaining usage time after a maintenance. \\
        % $S$               & Storage duration in number of periods. \\
        % $W_1$             & weight of the first objective in the objective function. \\
        % $W_2$             & weight of the second objective in the objective function. \\
        $N_t$             & number of resources in already-planned maintenances in period $t$.\\
        $Nk_{kt}$         & number of resources in cluster $k$ in already-planned maintenances in period $t$.\\
        % $D_t$             & number of resources to be assigned in total in period $t$. \\
        $AK_{kt}$         & maximum number of resources in cluster $k$ that can be simultaneously under maintenance at period $t$.\\
        $HK_{kt}$         & minimum number of total remaining usage time for cluster $k$ at period $t$.\\
        $Rut^{Init}_{i}$  & remaining usage time for resource $i$ at the start of the planning horizon. \\
        $Ret^{Init}_{i}$  & remaining elapsed time for resource $i$ at the start of the planning horizon. \\
        % $Ret^{Init}_{sum}$& sum of remaining elapsed times at the start of the planning horizon. \\
        % $Rut^{Init}_{sum}$& sum of remaining elapsed time at the start of the planning horizon. \\
    \end{tabular}

    \subsection{Parametric sets}

        \begin{tabular}{p{5mm}p{170mm}}
        $\mathcal{T}_j$     &  time periods $t \in \mathcal{T}$ in which task $j$ is active. \\
        $\mathcal{J}_t $    &  tasks $j \in \mathcal{J}$ to be realized in period $t$. \\
        $\mathcal{I}_j$     &  resources $i \in \mathcal{I}$ that can be assigned to task $j$. \\
        $\mathcal{I}_k$     &  resources $i \in \mathcal{I}$ that are included in cluster $k$. One resource can belong to more than one cluster. \\
        $\mathcal{O}_i$     &  tasks $j \in \mathcal{J}$ for which resource $i$ can be used. \\
        $\mathcal{T}^{s}_t$ &  time periods $t' \in \mathcal{T}$ such that $t' \in \{ \max{\{1, t - M+1\}},  ..., {t}\}$. \\
        % $\mathcal{T}^{st}_t$ &  time periods $t' \in \mathcal{T}$ such that $t' \in \{ \max{\{1, t - S+1\}},  ..., {t}$\}. \\
        $\mathcal{T}^{m}_t$ &  time periods $t' \in \mathcal{T}$ such that $t' \in \{ {t}, ..., \min{\{|\mathcal{T}|, t + E^{m}-1\}}\}$. \\
        $\mathcal{T}^{M}_t$ &  time periods $t' \leq |\mathcal{T}| - E^{M}$ such that $t' \in \{ t + E^{m}-1 , ...,  t + E^{M}-1 \}$. \\
        $\mathcal{T}^{m_{ini}}_i$ &  time periods $t \in \mathcal{T}$ such that $t \in \{ 1, ..., \max{\{0, Ret^{Init}_{i} - E^M + E^m \}}\}$. \\
        $\mathcal{T}^{M_{ini}}_i$ &  time periods $t \in \mathcal{T}$ such that $t \in \{ \max{\{0, Ret^{Init}_{i} - E^M + E^m \}} , ...,  Ret^{Init}_{i} \}$. \\
        $\mathcal{T}^{MT}_{jt}$ &  time periods $t' \in \mathcal{T}$ such that $t' \in \{ \max{\{1, t - MT_j\}},  ..., {t}\}$. \\
        $\mathcal{A}^{init}_{j}$  & resources $i \in \mathcal{I}$ that have task $j$ pre-assigned in the previous period to the start of the horizon. \\
    \end{tabular}

  \subsection{Variables}

     The following decision variables define a solution.
    
    \begin{tabular}{p{8mm}p{167mm}}
        $a_{jti}$   &  =1 if task $j \in J$ in period $t \in \mathcal{T}_j$ is realized with resource $i \in \mathcal{I}_j$, 0 otherwise. \\  
        $a^s_{jti}$ &  =1 if resource $i$ starts a new assignment to task $j$ in period $t$. If $a_{jti} = 1$ and $a_{j(t-1)i} = 0$. \\  
        $m_{it}$    &  =1 if resource $i \in I$ starts a maintenance operation in period $t \in \mathcal{T}$, 0 otherwise. \\
        % $s_{it}$    &  =1 if resource $i \in I$ starts a storage operation in period $t \in \mathcal{T}$, 0 otherwise. \\
        $rut_{it}$  &  remaining usage time (continuous) for resource $i \in I$ at the end of period $t \in \mathcal{T}$. \\  
        % $ret_{it}$  &  remaining elapsed time (integer) for resource $i \in I$ at the end of period $t \in \mathcal{T}$. \\  
        % $u_{max}$   &  maximal number (integer) of unavailable resources in any period. \\
        % $m_{max}$   &  maximal number (integer) of resources in maintenance in any period. \\
    \end{tabular}
    
    Note that $a_{jti}$ and $m_{it}$ are initially set up to 0 for all resources already in maintenance at the beginning of the planning horizon for the remaining time periods of maintenance. The remaining usage time for each resource at the beginning of the planning horizon is used to initialize $rut_{i0}$. 

  \subsection{Constraints}

    The objective is to minimize the total number of maintenances and, at the same time, maximize the end status of the resources.

    \begin{align}
        & \text{Min}\; \sum_{t \in \mathcal{T}, i \in \mathcal{I}} m_{it} \times H - \sum_{i \in \mathcal{I}} rut_{i|\mathcal{T}|}
    \end{align}
    
    where the first expression counts all the usage hours given to resources via maintenances and the second expression measures the amount of remaining usage hours in the resources at the end of the planning horizon.

    We want to minimize the total number of maintenances and we want to maximize the final state measured. These two objectives have the same units, can be easily compared and they ensure the resource hours are used in the most efficient way possible.

    The following constraints are used in the model:       
    \begin{align}
        % maximum capacity1:
        & \sum_{t' \in \mathcal{T}^{s}_t} \sum_{i \in \mathcal{I}} m_{it'} + N_t \leq M^{max}
          & t \in \mathcal{T} \label{eq:capacity1}\\
        % & \sum_{t \in \mathcal{T}, i \in \mathcal{I}} m_{it} \leq M^{max} \label{eq:capacity1}\\
        % availability
       % & \sum_{t' \in \mathcal{T}^{s}_t} \sum_{i \in \mathcal{I}} m_{it'} + N_t + D_t\leq u_{max} 
       %  &t \in \mathcal{T} \label{eq:avalaibility1}\\
        % min assignments:
        & \sum_{i \in \mathcal{I}_j} a_{jti} = R_j
                & j \in \mathcal{J}, t \in \mathcal{T}_j  \label{eq:taskres}\\
        % just doing one thing at any given time:
        & \sum_{t' \in \mathcal{T}^{s}_t} m_{it'} + \sum_{j \in \mathcal{J}_t \cap \mathcal{O}_i} a_{jti} \leq 1 
                & t \in \mathcal{T}, i \in \mathcal{I} \label{eq:state}
    \end{align}


    Maintenance capacity is controlled by (\ref{eq:capacity1}). Tasks' resource requirements are defined by (\ref{eq:taskres}). Constraints (\ref{eq:state}) guarantee that a resource can be used only for one task or a maintenance operation at the same period.  

    \begin{align}
        % if start task => assign start
        & a^s_{jti} \geq a_{jti} - a_{j(t-1)i}
                & t =1, ..., \mathcal{T}, j \in \mathcal{J}_t, i \in \mathcal{I}_j \label{eq:start1} \\
        & a^s_{j0i} \geq a_{j0i} - 1 \!1_{i \in \mathcal{A}^{init}_{j}}
                & j \in \mathcal{J}_0, i \in \mathcal{I}_j \label{eq:start2} \\        
      % # if we start a task, we need at least X periods of tasks assignments
        % & a^s_{jt'i} \leq a_{jti}
        % & j \in \mathcal{J}, t \in \mathcal{T}_j, i \in \mathcal{I}_j, t' \in \mathcal{T}^{MT}_{jt} \label{eq:start2} \\
        % better constraint:
        & \sum_{t' \in \mathcal{T}^{MT}_{jt}} a^s_{jt'i} \leq a_{jti} 
        & j \in \mathcal{J}, t \in \mathcal{T}_j, i \in \mathcal{I}_j \label{eq:start3}
    \end{align}

    Constraints (\ref{eq:start1}) control the definition of starting a consecutive assignment: the variable is active if a resource $i$ is assigned a task $j$ in period $t$ and was not assigned this same task in the previous period ($t-1$). Constraints (\ref{eq:start2}) are the particular case for the first period on the horizon where, the previous assignments are given.

    Constraints (\ref{eq:start3}) control the minimum duration of a consecutive task assignment. If an assignment to task $j$ is started in period $t$, it needs to continue for the following $t' \in \mathcal{T}^{MT}_{jt}$ periods. They are a stronger version of the constraint $ a^s_{jt'i} \leq a_{jti}$.

    \begin{align}
       & \sum_{t' \in \mathcal{T}^{s}_t} \sum_{i \in \mathcal{I}_k} m_{it'} + Nk_{kt} \leq AK_{kt}
        &k \in \mathcal{K}, t \in \mathcal{T} \label{eq:avalaibility-cluster} \\
       & \sum_{i \in \mathcal{I}_k} rut_{it} \geq HK_{kt}
        &k \in \mathcal{K}, t \in \mathcal{T} \label{eq:avalaibility-hours-cluster}
    \end{align}

    Constraints (\ref{eq:avalaibility-cluster}) guarantee a minimum availability of resources for each cluster $k$. A cluster is defined by the biggest group of resources that is required, exclusively, by at least one task. Constraints (\ref{eq:avalaibility-hours-cluster}) guarantee that a minimum availability in terms of usage houres for each cluster $k$.

    \begin{align}
        % remaining used time
         & rut_{it} \leq rut_{i(t-1)} + H m_{it} - \sum_{j \in \mathcal{J}_t \cap \mathcal{O}_i} a_{jti} H_j 
            & t =1, ..., \mathcal{T}, i \in \mathcal{I} \label{eq:rut_upper}\\
        & rut_{i0} = Rut^{Init}_i
               & i \in \mathcal{I} \label{eq:rut_initial}\\
        & rut_{it} \geq H m_{it'}
                & t \in \mathcal{T}, t' \in \mathcal{T}^{s}_t, i \in \mathcal{I}\label{eq:rut_lower}\\ 
        & rut_{it} \in [0,H]
                & t \in \mathcal{T}, i \in \mathcal{I} \label{eq:mu}              
        % & ret_{it} \leq ret_{it-1} - 1 + \sum_{t' \in \mathcal{T}^{st}_t} s_{it'} + E m_{it}
        %         & t =1, ..., \mathcal{T}, i \in \mathcal{I} \label{eq:ret_upper}\\
        % & ret_{i0} = Ret^{Init}_i
        %         & i \in \mathcal{I} \label{eq:ret_initial}\\
        % & ret_{it} \geq E m_{it}
        %         & t \in \mathcal{T}, i \in \mathcal{I}\label{eq:ret_lower}\\                 
        % & ret_{it} \in [0,E]
        %         & t \in \mathcal{T}, i \in \mathcal{I} \label{eq:me}\\
        % & \sum_{i \in \mathcal{I}} ret_{it} \geq Ret^{Init}_{sum}
        %       & t = |\mathcal{T}| \label{eq:min_ret}\\
        % & \sum_{i \in \mathcal{I}} rut_{i|\mathcal{T}|} \geq Rut^{Init}_{sum}\\
    \end{align}

        % These constraints calculate the balances of hours for each resource.
    The remaining usage time is defined by (\ref{eq:rut_upper})-(\ref{eq:rut_initial}) and its limits by (\ref{eq:rut_lower})-(\ref{eq:mu}). 

    \begin{align}
        & m_{it'} + m_{it} \leq 1
          & t \in \mathcal{T}, t' \in \mathcal{T}^{m}_t, i \in \mathcal{I}\label{eq:ret_min}\\ 
        & \sum_{t' \in \mathcal{T}^{M}_t} m_{it'} \geq  m_{it}
          & t \in \mathcal{T}, i \in \mathcal{I}\label{eq:ret_max}\\
        & m_{it} = 0
          & t \in \mathcal{T}^{m_{ini}}_i, i \in \mathcal{I}\label{eq:ret_min_init} \\
        & \sum_{t \in \mathcal{T}^{M_{ini}}_i} m_{it} \geq  1 
          & i \in \mathcal{I}\label{eq:ret_max_init}
    \end{align}

    The minimum and maximum elapsed time are defined by (\ref{eq:ret_min}) and (\ref{eq:ret_max}) respectively. Constraints (\ref{eq:ret_min}) guarantee that if a maintenance is done in some period $t$, we know that another one cannot be done in the immediately consecutive $t' \in \mathcal{T}^{m}_t$ periods. Constraints (\ref{eq:ret_max}) guarantee that, if we have a maintenance in period $t$, we need to start at least one maintenance among periods $t' \in \mathcal{T}^{M}_t$. Constraints (\ref{eq:ret_min_init}) and (\ref{eq:ret_max_init}) control the minimum and maximum remaining elapsed time at the beginning of the planning period, respectively. They follow the same logic as constraints (\ref{eq:ret_min}) and (\ref{eq:ret_max}), respectively, for the particular case of the start of the planning horizon.

    % Finally, constraints \ref{eq:min_rut} guarantee that resources have, globally, the same amount of remaining used and elapsed times at the beginning and at the end of the planning horizon.


\end{document}